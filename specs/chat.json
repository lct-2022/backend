{
  "methods": [
    {
      "name": "rpc.discover",
      "params": [],
      "result": {
        "name": "OpenRPC Schema",
        "schema": {
          "$ref": "https://raw.githubusercontent.com/open-rpc/meta-schema/master/schema.json"
        }
      }
    },
    {
      "name": "create-chat",
      "params": [
        {
          "name": "team-id",
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "private",
          "schema": {
            "type": "boolean"
          },
          "summary": "Если выставить в True, то в чат смогут писать только члены команды."
        }
      ],
      "result": {
        "name": "create-chat-result",
        "schema": {
          "type": "object",
          "properties": {
            "created-at": {
              "type": "object",
              "properties": {},
              "required": [],
              "x-cl-class": "T",
              "x-cl-package": "COMMON-LISP"
            },
            "updated-at": {
              "type": "object",
              "properties": {},
              "required": [],
              "x-cl-class": "T",
              "x-cl-package": "COMMON-LISP"
            },
            "synced": {
              "type": "boolean"
            },
            "id": {
              "type": "string"
            },
            "private": {
              "type": "string",
              "description": "Тип чата. Если private, то писать/читать его могут только члены команды."
            }
          },
          "required": [
            "private",
            "id",
            "updated-at",
            "created-at"
          ],
          "x-cl-class": "CHAT",
          "x-cl-package": "CHAT/CHAT/MODEL",
          "description": "Информация о чате."
        }
      },
      "summary": "Создаёт новый чат для команды.",
      "description": "Если private True, то в чат смогут писать не только члены команды, но и кто угодно.",
      "paramStructure": "by-name"
    },
    {
      "name": "get-members",
      "params": [
        {
          "name": "chat-id",
          "schema": {
            "type": "integer"
          },
          "required": true
        }
      ],
      "result": {
        "name": "get-members-result",
        "schema": {
          "type": "object",
          "properties": {
            "created-at": {
              "type": "object",
              "properties": {},
              "required": [],
              "x-cl-class": "T",
              "x-cl-package": "COMMON-LISP"
            },
            "updated-at": {
              "type": "object",
              "properties": {},
              "required": [],
              "x-cl-class": "T",
              "x-cl-package": "COMMON-LISP"
            },
            "synced": {
              "type": "boolean"
            },
            "chat-id": {
              "type": "string"
            },
            "user-id": {
              "type": "integer",
              "description": "ID пользователя, который состоит в чате.\n\n                            Для каждого члена команды будет такая запись,\n                            чтобы мы могли быстро определять,\n                            кто может писать в приватный чат, а кто нет."
            }
          },
          "required": [
            "user-id",
            "chat-id",
            "updated-at",
            "created-at"
          ],
          "x-cl-class": "CHAT-MEMBER",
          "x-cl-package": "CHAT/CHAT-MEMBER/MODEL",
          "description": "Привязка пользователя к чату."
        }
      },
      "summary": "Возвращает user-id всех участников чата.",
      "paramStructure": "by-name"
    },
    {
      "name": "post",
      "params": [
        {
          "name": "chat-id",
          "schema": {
            "type": "string"
          },
          "required": true
        },
        {
          "name": "message",
          "schema": {
            "type": "string"
          },
          "required": true
        }
      ],
      "result": {
        "name": "post-result",
        "schema": {
          "type": "object",
          "properties": {
            "created-at": {
              "type": "object",
              "properties": {},
              "required": [],
              "x-cl-class": "T",
              "x-cl-package": "COMMON-LISP"
            },
            "updated-at": {
              "type": "object",
              "properties": {},
              "required": [],
              "x-cl-class": "T",
              "x-cl-package": "COMMON-LISP"
            },
            "synced": {
              "type": "boolean"
            },
            "id": {
              "type": "integer"
            },
            "chat-id": {
              "type": "string"
            },
            "user-id": {
              "type": "integer",
              "description": "ID пользователя, который написал сообщение."
            },
            "message": {
              "type": "string",
              "description": "Текст сообщения"
            }
          },
          "required": [
            "message",
            "user-id",
            "chat-id",
            "id",
            "updated-at",
            "created-at"
          ],
          "x-cl-class": "MESSAGE",
          "x-cl-package": "CHAT/MESSAGE/MODEL",
          "description": "Одно сообщение из чата."
        }
      },
      "summary": "Добавляет в чат сообщение от текущего пользователя.",
      "paramStructure": "by-name"
    },
    {
      "name": "get-messages",
      "params": [
        {
          "name": "chat-id",
          "schema": {
            "type": "string"
          },
          "required": true
        },
        {
          "name": "page-key",
          "schema": {
            "type": "integer"
          }
        },
        {
          "name": "limit",
          "schema": {
            "type": "integer"
          }
        }
      ],
      "result": {
        "name": "get-messages-result",
        "schema": {
          "type": "object",
          "properties": {
            "items": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "created-at": {
                    "type": "object",
                    "properties": {},
                    "required": [],
                    "x-cl-class": "T",
                    "x-cl-package": "COMMON-LISP"
                  },
                  "updated-at": {
                    "type": "object",
                    "properties": {},
                    "required": [],
                    "x-cl-class": "T",
                    "x-cl-package": "COMMON-LISP"
                  },
                  "synced": {
                    "type": "boolean"
                  },
                  "id": {
                    "type": "integer"
                  },
                  "chat-id": {
                    "type": "string"
                  },
                  "user-id": {
                    "type": "integer",
                    "description": "ID пользователя, который написал сообщение."
                  },
                  "message": {
                    "type": "string",
                    "description": "Текст сообщения"
                  }
                },
                "required": [
                  "message",
                  "user-id",
                  "chat-id",
                  "id",
                  "updated-at",
                  "created-at"
                ],
                "x-cl-class": "MESSAGE",
                "x-cl-package": "CHAT/MESSAGE/MODEL",
                "description": "Одно сообщение из чата."
              }
            },
            "next-page-key": {
              "type": "string"
            }
          },
          "required": [
            "items"
          ],
          "x-paginated-list": true
        }
      },
      "summary": "Отдаёт сообщения из чата, с пейджинацией.",
      "description": "После того, как метод отдал пустую страницу, можно периодически\nвызывать его с тем же page-key, чтобы дождаться появления новых сообщений.\n\nПо-хорошему, в проде надо будет вместо поллинга использовать websocket или server-side-events.",
      "paramStructure": "by-name"
    }
  ],
  "openrpc": "1.0.0",
  "info": {
    "title": "Chat API",
    "version": "0.1.0"
  },
  "servers": [
    {
      "name": "default",
      "url": "https://localhost/"
    }
  ]
}